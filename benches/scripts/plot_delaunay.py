import matplotlib.pyplot as plt
from math import log2

def mlogn(n):
    m = 6 * n
    return 15 * m * log2(200 * n)

sizes = [1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000, 11000, 12000, 13000, 14000, 15000, 16000, 17000, 18000, 19000, 20000, 21000, 22000, 23000, 24000, 25000, 26000, 27000, 28000, 29000, 30000, 31000, 32000, 33000, 34000, 35000, 36000, 37000, 38000, 39000, 40000, 41000, 42000, 43000, 44000, 45000, 46000, 47000, 48000, 49000, 50000, 51000, 52000, 53000, 54000, 55000, 56000, 57000, 58000, 59000, 60000, 61000, 62000, 63000, 64000, 65000, 66000, 67000, 68000, 69000, 70000, 71000, 72000, 73000, 74000, 75000, 76000, 77000, 78000, 79000, 80000, 81000, 82000, 83000, 84000, 85000, 86000, 87000, 88000, 89000, 90000, 91000, 92000, 93000, 94000, 95000, 96000, 97000, 98000, 99000, 100000]
times = [1729782.2876242143, 3601277.797626643, 4699156.404490303, 7673040.15120623, 8487971.343178015, 10754345.747519556, 14602106.848588353, 15113506.999883136, 19705663.479163405, 19606179.274487093, 22242525.455962837, 27466342.533970047, 30305572.817955453, 29693021.342589986, 32374526.463510703, 35032660.49427636, 37727414.703035966, 43727164.15513991, 43492490.39507949, 45998892.16996797, 49533272.75833333, 51708686.08, 54462086.75, 62399654.48999999, 58311776.27, 65611878.03000001, 63165450.025, 66548228.35, 74928387.5625, 77485388.0875, 73484870.4875, 76046051.2625, 79349013.51666668, 87759928.79999998, 90714998.96666667, 92751656.78333333, 94619534.24999999, 92077209.68333334, 102297014.18333334, 103279600.31666668, 106341494.96666665, 103515634.13333334, 104986175.63333333, 109315463.48333335, 111750195.73333332, 114851762.38333333, 119289087.36666664, 122969797.55, 124937138.7, 136249580.375, 137633062.575, 130331635.85, 134569798.875, 136123685.675, 139906138.4, 153623308.275, 153090165.4, 148187232.875, 154104255.825, 156213302.15, 158235451.5, 162036171.65, 165191077.0, 169201708.625, 172398402.775, 174622909.8, 179161612.925, 192198847.575, 192632056.625, 181499828.75, 186931319.15, 192269557.775, 194905971.925, 213606226.975, 199671358.925, 202549772.0, 219961061.925, 206529300.55, 210816071.5, 228065350.85, 214603223.4, 233952213.775, 223519461.925, 226052102.875, 231052283.025, 235050806.6, 255698505.25, 239653437.275, 242375395.75, 245237847.325, 249670890.65, 256067512.3, 257872716.6, 264338111.6, 262280033.4, 266859700.1, 268131057.6, 272586398.7, 292335196.0, 272821499.2]

times = [t / 1_000_000 for t in times]
big_o = [mlogn(n) / 1_000_000 for n in sizes]
print(times)
print(big_o)

plt.plot(sizes, times, label='odd shortest path')
plt.plot(sizes, big_o, label='m log n')
plt.legend()
plt.xlabel('Vertices in the input graph')
plt.ylabel('Median time over 20 attempts (ms)')
plt.title('Worst case odd shortest path on Delaunay graphs')
plt.savefig('../benches/figures/delaunay.png')
plt.show()
